(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      8751,        260]
NotebookOptionsPosition[      7593,        234]
NotebookOutlinePosition[      7984,        250]
CellTagsIndexPosition[      7941,        247]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"HB", "[", 
    RowBox[{
    "t_", ",", "alpha_", ",", "qB_", ",", "qI_", ",", "S_", ",", "nuU_", ",", 
     "xB_"}], "]"}], ":="}]}]], "Input",
 CellChangeTimes->{{3.9260534681049843`*^9, 
  3.926053468283777*^9}},ExpressionUUID->"62313603-1793-42ac-8ccf-\
92798c6e90db"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"HB", "[", 
     RowBox[{
     "t", ",", "alpha", ",", "qB", ",", "qI", ",", "S", ",", "nuU", ",", 
      "xB"}], "]"}], ",", "t"}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.92605347064679*^9, 
  3.9260534708377037`*^9}},ExpressionUUID->"ccfe8e7c-964e-48b0-a884-\
719df0acc929"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"u", "[", 
   RowBox[{"t_", ",", "s_", ",", "x_", ",", "q_", ",", "d_", ",", "z_"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.926053472205945*^9, 
  3.9260535143879147`*^9}},ExpressionUUID->"67ae03e8-e7dd-4595-a7c1-\
47db297090d0"],

Cell[BoxData[
 RowBox[{"PDE", ":=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"h", "[", 
      RowBox[{"t", ",", "q", ",", "d", ",", "z"}], "]"}], ",", "t"}], "]"}], 
   "+", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"sigmaZ", "^", "2"}], "/", "2"}], "*", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"t", ",", "q", ",", "d", ",", "z"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", "2"}], "}"}]}], "]"}]}], "-", " ", 
   RowBox[{"phi", "*", 
    RowBox[{"q", "^", "2"}]}], "+", 
   RowBox[{"lambdaA", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"t", ",", "q", ",", 
        RowBox[{"d", "-", "1"}], ",", "z"}], "]"}], "-", 
      RowBox[{"h", "[", 
       RowBox[{"t", ",", "q", ",", "d", ",", "z"}], "]"}], "+", 
      RowBox[{
       RowBox[{"1", "/", "kappa"}], "*", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "1"}], "-", 
         RowBox[{"kappa", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"h", "[", 
              RowBox[{"t", ",", 
               RowBox[{"q", "-", "1"}], ",", "d", ",", "z"}], "]"}]}], "+", 
            RowBox[{"h", "[", 
             RowBox[{"t", ",", "q", ",", 
              RowBox[{"d", "-", "1"}], ",", "z"}], "]"}], " ", "-", "alphaA", 
            "-", 
            RowBox[{"beta", "*", 
             RowBox[{"(", 
              RowBox[{"d", "+", "z"}], ")"}]}]}], ")"}]}]}], "]"}]}]}], 
     ")"}]}], "+", 
   RowBox[{"lambdaB", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"t", ",", "q", ",", 
        RowBox[{"d", "+", "1"}], ",", "z"}], "]"}], "-", 
      RowBox[{"h", "[", 
       RowBox[{"t", ",", "q", ",", "d", ",", "z"}], "]"}], "+", 
      RowBox[{
       RowBox[{"1", "/", "kappa"}], "*", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "1"}], "-", 
         RowBox[{"kappa", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"h", "[", 
              RowBox[{"t", ",", 
               RowBox[{"q", "+", "1"}], ",", "d", ",", "z"}], "]"}]}], "+", 
            RowBox[{"h", "[", 
             RowBox[{"t", ",", "q", ",", 
              RowBox[{"d", "+", "1"}], ",", "z"}], "]"}], " ", "-", "alphaB", 
            "+", 
            RowBox[{"beta", "*", 
             RowBox[{"(", 
              RowBox[{"d", "+", "z"}], ")"}]}]}], ")"}]}]}], "]"}]}]}], 
     ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.926053511713028*^9, 3.9260537834546137`*^9}, {
  3.926053865764566*^9, 3.926053881742145*^9}, {3.9260539201045647`*^9, 
  3.926053971699246*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"615d55f3-fb4f-487c-b565-3a7496fa2dcc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"h", "[", 
   RowBox[{"t_", ",", "q_", ",", "d_", ",", "z_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"g", "[", 
    RowBox[{"t", ",", "q"}], "]"}], "+", " ", 
   RowBox[{"beta", "*", "q", "*", 
    RowBox[{"(", 
     RowBox[{"d", "+", "z"}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.926053802986537*^9, 3.9260538236866007`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"95d9f0ee-c710-4e16-b3a5-387ac07a2053"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", "PDE", "]"}]], "Input",
 CellChangeTimes->{{3.926053829875478*^9, 3.926053834394849*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"2039b856-0e68-445b-9507-0accc495f438"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "kappa"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"alphaA", " ", "kappa"}], "+", 
        RowBox[{"beta", " ", "kappa", " ", "q"}], "+", 
        RowBox[{"kappa", " ", 
         RowBox[{"g", "[", 
          RowBox[{"t", ",", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "q"}]}], "]"}]}], "-", 
        RowBox[{"kappa", " ", 
         RowBox[{"g", "[", 
          RowBox[{"t", ",", "q"}], "]"}]}]}]], " ", "lambdaA"}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"alphaB", " ", "kappa"}], "-", 
        RowBox[{"beta", " ", "kappa", " ", "q"}], "-", 
        RowBox[{"kappa", " ", 
         RowBox[{"g", "[", 
          RowBox[{"t", ",", "q"}], "]"}]}], "+", 
        RowBox[{"kappa", " ", 
         RowBox[{"g", "[", 
          RowBox[{"t", ",", 
           RowBox[{"1", "+", "q"}]}], "]"}]}]}]], " ", "lambdaB"}], "-", 
     RowBox[{"kappa", " ", "q", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"beta", " ", "lambdaA"}], "-", 
        RowBox[{"beta", " ", "lambdaB"}], "+", 
        RowBox[{"phi", " ", "q"}]}], ")"}]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["g", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"1", ",", "0"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"t", ",", "q"}], "]"}]}]], "Output",
 CellChangeTimes->{3.926053836065227*^9, 3.9260538849166193`*^9, 
  3.9260539758062487`*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"f8d69c6e-0a5a-4307-930e-d5f2e9884e52"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"h", "[", 
     RowBox[{"t", ",", 
      RowBox[{"q", "-", "1"}], ",", "d", ",", "z"}], "]"}]}], "+", 
   RowBox[{"h", "[", 
    RowBox[{"t", ",", "q", ",", 
     RowBox[{"d", "-", "1"}], ",", "z"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.926054039197641*^9, 3.926054059853341*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"fa01513c-ec47-4eed-aa05-fb0a86e20c53"],

Cell[BoxData[
 RowBox[{
  RowBox[{"beta", " ", 
   RowBox[{"(", 
    RowBox[{"d", "-", "q", "+", "z"}], ")"}]}], "-", 
  RowBox[{"g", "[", 
   RowBox[{"t", ",", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "q"}]}], "]"}], "+", 
  RowBox[{"g", "[", 
   RowBox[{"t", ",", "q"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.926054053924303*^9, 3.926054060339086*^9}},
 CellLabel->"Out[12]=",ExpressionUUID->"9c29918c-a579-4426-8430-8e6813002220"]
}, Open  ]]
},
WindowSize->{808, 911},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
FrontEndVersion->"13.3 for Mac OS X ARM (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"be4d6b73-b1b0-4af6-be72-41f40b44d554"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 324, 9, 30, "Input",ExpressionUUID->"62313603-1793-42ac-8ccf-92798c6e90db"],
Cell[885, 31, 358, 10, 30, "Input",ExpressionUUID->"ccfe8e7c-964e-48b0-a884-719df0acc929"],
Cell[1246, 43, 275, 7, 30, "Input",ExpressionUUID->"67ae03e8-e7dd-4595-a7c1-47db297090d0"],
Cell[1524, 52, 2747, 78, 157, "Input",ExpressionUUID->"615d55f3-fb4f-487c-b565-3a7496fa2dcc"],
Cell[4274, 132, 442, 11, 30, "Input",ExpressionUUID->"95d9f0ee-c710-4e16-b3a5-387ac07a2053"],
Cell[CellGroupData[{
Cell[4741, 147, 208, 3, 30, "Input",ExpressionUUID->"2039b856-0e68-445b-9507-0accc495f438"],
Cell[4952, 152, 1694, 49, 99, "Output",ExpressionUUID->"f8d69c6e-0a5a-4307-930e-d5f2e9884e52"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6683, 206, 451, 11, 30, "Input",ExpressionUUID->"fa01513c-ec47-4eed-aa05-fb0a86e20c53"],
Cell[7137, 219, 440, 12, 57, "Output",ExpressionUUID->"9c29918c-a579-4426-8430-8e6813002220"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

